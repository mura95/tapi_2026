# ãƒ¢ãƒ¼ãƒ‰é¸æŠç”»é¢

## 1. æ¦‚è¦

ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«ã€ŒãŸã£ã·ãƒã‚¦ã‚¹ã€ã‹ã€ŒãŸã£ã·ãƒã‚±ãƒƒãƒˆã€ã‚’é¸æŠã™ã‚‹ç”»é¢ã€‚é¸æŠã«å¿œã˜ã¦ãƒ­ã‚°ã‚¤ãƒ³æ–¹æ³•ã¨é·ç§»å…ˆãŒå¤‰ã‚ã‚‹ã€‚

---

## 2. ç”»é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚                    ãŸã£ã·ã¸ã‚ˆã†ã“ãï¼                       â”‚
â”‚                                                             â”‚
â”‚                    ã©ã¡ã‚‰ã§ä½¿ã„ã¾ã™ã‹ï¼Ÿ                     â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                     â”‚   â”‚
â”‚   â”‚                      ğŸ                             â”‚   â”‚
â”‚   â”‚                                                     â”‚   â”‚
â”‚   â”‚                 ãŸã£ã·ãƒã‚¦ã‚¹                        â”‚   â”‚
â”‚   â”‚                                                     â”‚   â”‚
â”‚   â”‚            ç½®ãå‹ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã§ä½¿ã†æ–¹                 â”‚   â”‚
â”‚   â”‚                                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                     â”‚   â”‚
â”‚   â”‚                      ğŸ“±                            â”‚   â”‚
â”‚   â”‚                                                     â”‚   â”‚
â”‚   â”‚                ãŸã£ã·ãƒã‚±ãƒƒãƒˆ                       â”‚   â”‚
â”‚   â”‚                                                     â”‚   â”‚
â”‚   â”‚             ã‚¹ãƒãƒ›ã§æŒã¡æ­©ã„ã¦ä½¿ã†æ–¹                â”‚   â”‚
â”‚   â”‚                                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. é¸æŠå¾Œã®ãƒ•ãƒ­ãƒ¼

### 3.1 ãŸã£ã·ãƒã‚¦ã‚¹é¸æŠæ™‚

```
ãƒ¢ãƒ¼ãƒ‰é¸æŠç”»é¢
    â†“ ã€ŒãŸã£ã·ãƒã‚¦ã‚¹ã€æŠ¼ä¸‹
AppMode = TapHouse ã‚’ä¿å­˜
    â†“
login.unityï¼ˆUnityå†…ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ï¼‰ã¸é·ç§»
    â†“
ãƒ¡ãƒ¼ãƒ«/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ãƒ­ã‚°ã‚¤ãƒ³
    â†“
main.unity ã¸é·ç§»
```

### 3.2 ãŸã£ã·ãƒã‚±ãƒƒãƒˆé¸æŠæ™‚

```
ãƒ¢ãƒ¼ãƒ‰é¸æŠç”»é¢
    â†“ ã€ŒãŸã£ã·ãƒã‚±ãƒƒãƒˆã€æŠ¼ä¸‹
AppMode = TapPocket ã‚’ä¿å­˜
    â†“
OSãƒ–ãƒ©ã‚¦ã‚¶ã‚’èµ·å‹•
https://taphouse.web.app/login
    â†“
ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆãƒ¡ãƒ¼ãƒ« or Googleï¼‰
    â†“
Deep Link ã§ã‚¢ãƒ—ãƒªã«æˆ»ã‚‹
    â†“
PocketMain.unity ã¸é·ç§»
```

---

## 4. èªè¨¼çŠ¶æ…‹ã«ã‚ˆã‚‹åˆ†å²

### 4.1 å®Œå…¨ãƒ•ãƒ­ãƒ¼å›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      èµ·å‹•æ™‚ã®åˆ†å²                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚                      ã‚¢ãƒ—ãƒªèµ·å‹•                             â”‚
â”‚                          â†“                                 â”‚
â”‚                  ModeSelect.unity                          â”‚
â”‚                          â†“                                 â”‚
â”‚                   Firebase åˆæœŸåŒ–                          â”‚
â”‚                          â†“                                 â”‚
â”‚                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚                â”‚ CurrentUserç¢ºèª â”‚                         â”‚
â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                         â”‚                                  â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚           â”‚                           â”‚                   â”‚
â”‚       != null                      == null                â”‚
â”‚      (ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿)                (æœªãƒ­ã‚°ã‚¤ãƒ³)             â”‚
â”‚           â”‚                           â”‚                   â”‚
â”‚           â–¼                           â–¼                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ ä¿å­˜ã•ã‚ŒãŸAppModeâ”‚         â”‚ ãƒ¢ãƒ¼ãƒ‰é¸æŠUIã‚’  â”‚         â”‚
â”‚  â”‚ ã‚’ç¢ºèªâ†’å³é·ç§»   â”‚         â”‚ è¡¨ç¤º           â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚           â”‚                           â”‚                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚    â”‚             â”‚           â”‚                â”‚         â”‚
â”‚ TapHouse    TapPocket   ã€Œãƒã‚¦ã‚¹ã€        ã€Œãƒã‚±ãƒƒãƒˆã€     â”‚
â”‚    â”‚             â”‚           â”‚                â”‚         â”‚
â”‚    â†“             â†“           â†“                â†“         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚main  â”‚    â”‚Pocket  â”‚  â”‚login   â”‚      â”‚OSãƒ–ãƒ©ã‚¦ã‚¶â”‚     â”‚
â”‚ â”‚.unityâ”‚    â”‚Main    â”‚  â”‚.unity  â”‚      â”‚ãƒ­ã‚°ã‚¤ãƒ³ â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜    â”‚.unity  â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜     â”‚
â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚                â”‚         â”‚
â”‚                             â†“                â†“         â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚                        â”‚main    â”‚      â”‚Pocket  â”‚     â”‚
â”‚                        â”‚.unity  â”‚      â”‚Main    â”‚     â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚.unity  â”‚     â”‚
â”‚                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. å®Ÿè£…

å®Ÿè£…æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«:
- `Assets/Scripts/UI/ModeSelect/ModeSelectManager.cs`
- `Assets/Scripts/UI/ModeSelect/AppModeManager.cs`

### 5.1 ModeSelectManager.cs

```csharp
// ä¸»è¦ãªå‡¦ç†ã®ã¿æŠœç²‹ï¼ˆå®Œå…¨ç‰ˆã¯ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å‚ç…§ï¼‰

public class ModeSelectManager : MonoBehaviour
{
    [SerializeField] private GameObject modeSelectUI;
    [SerializeField] private Button tapHouseButton;
    [SerializeField] private Button tapPocketButton;

    async void Start()
    {
        modeSelectUI.SetActive(false);

        var auth = FirebaseAuth.DefaultInstance;

        if (auth.CurrentUser != null)
        {
            // ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ â†’ ä¿å­˜ãƒ¢ãƒ¼ãƒ‰ã§å³é·ç§»
            var mode = AppModeManager.Load();
            string scene = mode == AppMode.TapPocket ? "PocketMain" : "Main";
            SceneManager.LoadSceneAsync(scene);
        }
        else
        {
            // æœªãƒ­ã‚°ã‚¤ãƒ³ â†’ ãƒ¢ãƒ¼ãƒ‰é¸æŠUIã‚’è¡¨ç¤º
            modeSelectUI.SetActive(true);
        }
    }

    public void OnTapHouseSelected()
    {
        AppModeManager.Save(AppMode.TapHouse);
        SceneManager.LoadScene("login");
    }

    public void OnTapPocketSelected()
    {
        AppModeManager.Save(AppMode.TapPocket);
        ShowStatus("ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ­ã‚°ã‚¤ãƒ³ä¸­â€¦");
        _pocketAuth.OpenBrowserLogin();
    }
}
```

### 5.2 AppModeManager.cs

```csharp
public enum AppMode
{
    TapHouse,  // ãŸã£ã·ãƒã‚¦ã‚¹ï¼ˆã‚¿ãƒ–ãƒ¬ãƒƒãƒˆç”¨ï¼‰
    TapPocket  // ãŸã£ã·ãƒã‚±ãƒƒãƒˆï¼ˆã‚¹ãƒãƒ›ç”¨ï¼‰
}

public static class AppModeManager
{
    public static void Save(AppMode mode);
    public static AppMode Load();        // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: TapHouse
    public static bool HasSavedMode();
    public static void Clear();
}
```

---

## 6. ã‚·ãƒ¼ãƒ³æ§‹æˆ

```
Assets/Scenes/
â”œâ”€â”€ ModeSelect.unity    # èµ·å‹•ãƒ»ãƒ¢ãƒ¼ãƒ‰é¸æŠç”»é¢ï¼ˆModeSelectManagerï¼‰
â”œâ”€â”€ login.unity         # ãŸã£ã·ãƒã‚¦ã‚¹ç”¨ãƒ­ã‚°ã‚¤ãƒ³
â”œâ”€â”€ main.unity          # ãŸã£ã·ãƒã‚¦ã‚¹ ãƒ¡ã‚¤ãƒ³ç”»é¢
â””â”€â”€ PocketMain.unity    # ãŸã£ã·ãƒã‚±ãƒƒãƒˆ ãƒ¡ã‚¤ãƒ³ç”»é¢
```

### èµ·å‹•é †åº

```
1. ModeSelect.unityï¼ˆãƒ“ãƒ«ãƒ‰è¨­å®šã§æœ€åˆã®ã‚·ãƒ¼ãƒ³ã«è¨­å®šï¼‰
       â†“
   FirebaseåˆæœŸåŒ– â†’ èªè¨¼çŠ¶æ…‹ç¢ºèª
       â†“
2a. ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ â†’ main.unity or PocketMain.unityï¼ˆå³é·ç§»ï¼‰
2b. æœªãƒ­ã‚°ã‚¤ãƒ³ â†’ ãƒ¢ãƒ¼ãƒ‰é¸æŠUIã‚’è¡¨ç¤º
       â†“
3a. ãƒã‚¦ã‚¹é¸æŠ â†’ login.unity â†’ main.unity
3b. ãƒã‚±ãƒƒãƒˆé¸æŠ â†’ OSãƒ–ãƒ©ã‚¦ã‚¶ â†’ (Deep Link) â†’ PocketMain.unity
```

---

## 7. ãƒ¢ãƒ¼ãƒ‰å¤‰æ›´

### 7.1 è¨­å®šç”»é¢ã‹ã‚‰å¤‰æ›´å¯èƒ½

```
è¨­å®šç”»é¢
â””â”€â”€ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­å®š
    â””â”€â”€ ã‚¢ãƒ—ãƒªãƒ¢ãƒ¼ãƒ‰å¤‰æ›´
        â”œâ”€â”€ ç¾åœ¨: ãŸã£ã·ãƒã‚¦ã‚¹
        â””â”€â”€ [ãƒã‚±ãƒƒãƒˆã«åˆ‡ã‚Šæ›¿ãˆ]
            â””â”€â”€ ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°
                â””â”€â”€ ã€Œåˆ‡ã‚Šæ›¿ãˆã‚‹ã¨ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã™ã€
                    â””â”€â”€ OK â†’ ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ â†’ ModeSelect.unity
```

### 7.2 ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ™‚

```csharp
public void Logout()
{
    // Firebase ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆ
    FirebaseAuth.DefaultInstance.SignOut();

    // ä¿å­˜ã•ã‚ŒãŸãƒ¢ãƒ¼ãƒ‰ã‚’ã‚¯ãƒªã‚¢
    AppModeManager.Clear();

    // ãƒ¢ãƒ¼ãƒ‰é¸æŠç”»é¢ã¸
    SceneManager.LoadScene("ModeSelect");
}
```

---

## 8. UIä»•æ§˜

### 8.1 ãƒœã‚¿ãƒ³ã‚µã‚¤ã‚º

é«˜é½¢è€…å‘ã‘ã«å¤§ããªã‚¿ãƒƒãƒ—é ˜åŸŸã‚’ç¢ºä¿ï¼š

| è¦ç´  | ã‚µã‚¤ã‚º |
|------|--------|
| ãƒœã‚¿ãƒ³é«˜ã• | 150dpä»¥ä¸Š |
| ã‚¢ã‚¤ã‚³ãƒ³ã‚µã‚¤ã‚º | 64dp |
| ãƒ†ã‚­ã‚¹ãƒˆã‚µã‚¤ã‚º | 24spï¼ˆã‚¿ã‚¤ãƒˆãƒ«ï¼‰/ 16spï¼ˆèª¬æ˜ï¼‰ |
| ãƒœã‚¿ãƒ³é–“ä½™ç™½ | 24dp |

### 8.2 è‰²è¨­è¨ˆ

| è¦ç´  | è‰² |
|------|-----|
| ãŸã£ã·ãƒã‚¦ã‚¹ãƒœã‚¿ãƒ³ | æš–è‰²ç³»ï¼ˆã‚ªãƒ¬ãƒ³ã‚¸/èŒ¶è‰²ï¼‰ |
| ãŸã£ã·ãƒã‚±ãƒƒãƒˆãƒœã‚¿ãƒ³ | å¯’è‰²ç³»ï¼ˆé’/æ°´è‰²ï¼‰ |
| èƒŒæ™¯ | è–„ã„ãƒ™ãƒ¼ã‚¸ãƒ¥ or ç™½ |

---

## 9. ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

Unityã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã§ã®è©³ç´°ãªã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †ã¯ [mode-select-setup.md](./mode-select-setup.md) ã‚’å‚ç…§ã€‚
