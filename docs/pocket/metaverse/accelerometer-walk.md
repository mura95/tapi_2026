# åŠ é€Ÿåº¦ã‚»ãƒ³ã‚µãƒ¼æ­©è¡Œé€£å‹•

## 1. æ¦‚è¦

ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã®åŠ é€Ÿåº¦ã‚»ãƒ³ã‚µãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã€å®Ÿéš›ã«æ­©ã/æŒ¯ã‚‹å‹•ä½œã‚’ãƒ¡ã‚¿ãƒãƒ¼ã‚¹å†…ã®ç§»å‹•ã«é€£å‹•ã•ã›ã‚‹æ©Ÿèƒ½ã€‚é«˜é½¢è€…ãŒå®Ÿéš›ã«ä½“ã‚’å‹•ã‹ã—ãªãŒã‚‰ãƒ¡ã‚¿ãƒãƒ¼ã‚¹ã‚’æ¥½ã—ã‚ã‚‹ã€‚

---

## 2. ã‚³ãƒ³ã‚»ãƒ—ãƒˆ

### 2.1 æ­©è¡Œé€£å‹•ã®ä»•çµ„ã¿

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åŠ é€Ÿåº¦ã‚»ãƒ³ã‚µãƒ¼æ­©è¡Œé€£å‹•                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   å®Ÿä¸–ç•Œ                       ãƒ¡ã‚¿ãƒãƒ¼ã‚¹                   â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚             â”‚             â”‚             â”‚              â”‚
â”‚   â”‚  ğŸ‘¤ æ­©ã    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚  ğŸ‘¤ æ­©ã    â”‚              â”‚
â”‚   â”‚  ğŸ“±         â”‚  åŠ é€Ÿåº¦     â”‚  ğŸ•         â”‚              â”‚
â”‚   â”‚             â”‚  ã‚»ãƒ³ã‚µãƒ¼   â”‚             â”‚              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                             â”‚
â”‚   ã€æ¤œå‡ºæ–¹æ³•ã€‘                                               â”‚
â”‚   - ã‚¹ãƒãƒ›ã‚’æŒã£ã¦æ­©ã â†’ ä¸Šä¸‹ã®åŠ é€Ÿåº¦å¤‰åŒ–ã‚’æ¤œå‡º             â”‚
â”‚   - ã‚¹ãƒãƒ›ã‚’å·¦å³ã«æŒ¯ã‚‹ â†’ å·¦å³ã®åŠ é€Ÿåº¦å¤‰åŒ–ã‚’æ¤œå‡º             â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æ“ä½œãƒ‘ã‚¿ãƒ¼ãƒ³

| æ“ä½œ | å‹•ä½œ | å¯¾è±¡ |
|------|------|------|
| æ­©ãï¼ˆã‚¹ãƒãƒ›ã‚’æŒã£ã¦ï¼‰ | å‰é€² | æ­©ã‘ã‚‹äººå‘ã‘ |
| å·¦å³ã«æŒ¯ã‚‹ | å‰é€² | åº§ã£ãŸã¾ã¾ã®äººå‘ã‘ |
| å‚¾ã‘ã‚‹ | æ–¹å‘è»¢æ› | å…±é€š |

---

## 3. åŠ é€Ÿåº¦ã‚»ãƒ³ã‚µãƒ¼ã®ä½¿ç”¨

### 3.1 Unityã§ã®å–å¾—

```csharp
using UnityEngine;

public class AccelerometerReader : MonoBehaviour
{
    // åŠ é€Ÿåº¦ã‚’å–å¾—
    public Vector3 GetAcceleration()
    {
        return Input.acceleration;
    }

    // ãƒ­ãƒ¼ãƒ‘ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
    public Vector3 GetFilteredAcceleration(float alpha = 0.8f)
    {
        Vector3 raw = Input.acceleration;
        filteredAcceleration = Vector3.Lerp(filteredAcceleration, raw, alpha);
        return filteredAcceleration;
    }

    private Vector3 filteredAcceleration;
}
```

### 3.2 æ­©è¡Œæ¤œå‡ºã®åŸç†

```
åŠ é€Ÿåº¦ã®å¤‰åŒ–ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆæ­©è¡Œæ™‚ï¼‰

    Yè»¸åŠ é€Ÿåº¦
      â†‘
    1.2 â”¤     *       *
    1.0 â”¤   *   *   *   *
    0.8 â”¤  *     * *     *
    0.6 â”¤ *               *
      â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ æ™‚é–“
        â”‚ è¶³ãŒ   è¶³ãŒ   è¶³ãŒ
        â”‚ ç€åœ°   é›¢åœ°   ç€åœ°

    æ­©è¡Œ = åŠ é€Ÿåº¦ã®ãƒ”ãƒ¼ã‚¯ãŒå‘¨æœŸçš„ã«ç™ºç”Ÿ
```

---

## 4. å®Ÿè£…

### 4.1 AccelerometerWalkController.cs

```csharp
using UnityEngine;
using System.Collections.Generic;

namespace TapHouse.Pocket.Metaverse
{
    public class AccelerometerWalkController : MonoBehaviour
    {
        [Header("Settings")]
        [SerializeField] private float stepThreshold = 0.3f;      // æ­©è¡Œæ¤œå‡ºé–¾å€¤
        [SerializeField] private float stepCooldown = 0.3f;       // é€£ç¶šæ¤œå‡ºé˜²æ­¢
        [SerializeField] private float moveSpeed = 2f;            // ç§»å‹•é€Ÿåº¦
        [SerializeField] private float turnSensitivity = 60f;     // å›è»¢æ„Ÿåº¦

        [Header("Filter")]
        [SerializeField] private float lowPassAlpha = 0.8f;       // ãƒ­ãƒ¼ãƒ‘ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ä¿‚æ•°

        [Header("Debug")]
        [SerializeField] private bool enableDebugLog = false;

        // çŠ¶æ…‹
        private Vector3 filteredAcceleration;
        private float lastStepTime;
        private float lastMagnitude;
        private bool isWalking;

        // ã‚¤ãƒ™ãƒ³ãƒˆ
        public event System.Action OnStepDetected;
        public event System.Action<bool> OnWalkingStateChanged;

        // å‡ºåŠ›
        public Vector3 MoveDirection { get; private set; }
        public float TurnAngle { get; private set; }
        public bool IsWalking => isWalking;
        public int StepCount { get; private set; }

        private void Update()
        {
            UpdateAcceleration();
            DetectStep();
            UpdateMovement();
        }

        private void UpdateAcceleration()
        {
            // ãƒ­ãƒ¼ãƒ‘ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã§é«˜å‘¨æ³¢ãƒã‚¤ã‚ºã‚’é™¤å»
            Vector3 raw = Input.acceleration;
            filteredAcceleration = Vector3.Lerp(filteredAcceleration, raw, lowPassAlpha * Time.deltaTime * 10);
        }

        private void DetectStep()
        {
            // é‡åŠ›æˆåˆ†ã‚’é™¤å»ã—ãŸåŠ é€Ÿåº¦ã®å¤§ãã•
            Vector3 gravity = filteredAcceleration.normalized;
            Vector3 linearAcceleration = Input.acceleration - gravity;
            float magnitude = linearAcceleration.magnitude;

            // ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ä¸­ã¯æ¤œå‡ºã—ãªã„
            if (Time.time - lastStepTime < stepCooldown)
            {
                lastMagnitude = magnitude;
                return;
            }

            // ãƒ”ãƒ¼ã‚¯æ¤œå‡ºï¼ˆå‰ãƒ•ãƒ¬ãƒ¼ãƒ ã‚ˆã‚Šå¤§ããã€é–¾å€¤ã‚’è¶…ãˆã¦ã„ã‚‹ï¼‰
            if (magnitude > stepThreshold && magnitude > lastMagnitude && lastMagnitude < stepThreshold)
            {
                // æ­©è¡Œæ¤œå‡º
                lastStepTime = Time.time;
                StepCount++;
                OnStepDetected?.Invoke();

                if (!isWalking)
                {
                    isWalking = true;
                    OnWalkingStateChanged?.Invoke(true);
                }

                if (enableDebugLog)
                {
                    Debug.Log($"[AccelerometerWalk] Step detected! Count: {StepCount}, Magnitude: {magnitude:F2}");
                }
            }

            lastMagnitude = magnitude;

            // ä¸€å®šæ™‚é–“æ­©è¡ŒãŒæ¤œå‡ºã•ã‚Œãªã‘ã‚Œã°åœæ­¢
            if (isWalking && Time.time - lastStepTime > 1.0f)
            {
                isWalking = false;
                OnWalkingStateChanged?.Invoke(false);
            }
        }

        private void UpdateMovement()
        {
            if (!isWalking)
            {
                MoveDirection = Vector3.zero;
                return;
            }

            // å‰é€²æ–¹å‘
            MoveDirection = transform.forward * moveSpeed;

            // å‚¾ãã«ã‚ˆã‚‹æ–¹å‘è»¢æ›
            // Xè»¸ã®å‚¾ã = å·¦å³ã®å‚¾ã
            float tilt = filteredAcceleration.x;
            TurnAngle = tilt * turnSensitivity;
        }

        /// <summary>
        /// æ„Ÿåº¦èª¿æ•´ï¼ˆè¨­å®šç”»é¢ã‹ã‚‰å‘¼ã³å‡ºã—ï¼‰
        /// </summary>
        public void SetSensitivity(float sensitivity)
        {
            // 0.5 ~ 1.5 ã®ç¯„å›²
            stepThreshold = 0.3f / sensitivity;
        }

        /// <summary>
        /// ã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç¾åœ¨ã®å§¿å‹¢ã‚’åŸºæº–ã«ã™ã‚‹ï¼‰
        /// </summary>
        public void Calibrate()
        {
            // ç¾åœ¨ã®åŠ é€Ÿåº¦ã‚’åŸºæº–å€¤ã¨ã—ã¦è¨˜éŒ²
            filteredAcceleration = Input.acceleration;
        }

        /// <summary>
        /// æ­©æ•°ãƒªã‚»ãƒƒãƒˆ
        /// </summary>
        public void ResetStepCount()
        {
            StepCount = 0;
        }
    }
}
```

### 4.2 MetaversePlayerController ã¨ã®é€£æº

```csharp
using UnityEngine;

namespace TapHouse.Pocket.Metaverse
{
    public class PocketMetaversePlayerController : MonoBehaviour
    {
        [Header("Components")]
        [SerializeField] private CharacterController characterController;
        [SerializeField] private AccelerometerWalkController walkController;

        [Header("Settings")]
        [SerializeField] private float moveSpeed = 3f;
        [SerializeField] private float turnSpeed = 90f;

        private void Update()
        {
            // åŠ é€Ÿåº¦ã‚»ãƒ³ã‚µãƒ¼ã‹ã‚‰ã®å…¥åŠ›ã§ç§»å‹•
            if (walkController.IsWalking)
            {
                // å‰é€²
                Vector3 move = transform.forward * moveSpeed * Time.deltaTime;
                characterController.Move(move);

                // æ–¹å‘è»¢æ›
                float turn = walkController.TurnAngle * Time.deltaTime;
                transform.Rotate(0, turn, 0);
            }
        }
    }
}
```

---

## 5. æ­©è¡Œæ¤œå‡ºã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

### 5.1 ãƒ”ãƒ¼ã‚¯æ¤œå‡ºæ³•

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ãƒ”ãƒ¼ã‚¯æ¤œå‡ºã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   åŠ é€Ÿåº¦                                                    â”‚
â”‚      â†‘                                                      â”‚
â”‚      â”‚     *       *       *                               â”‚
â”‚   é–¾å€¤â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ threshold               â”‚
â”‚      â”‚   *   *   *   *   *   *                             â”‚
â”‚      â”‚  *     * *     * *     *                            â”‚
â”‚      â”‚ *               *       *                           â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ æ™‚é–“                  â”‚
â”‚            â†‘       â†‘       â†‘                               â”‚
â”‚          Step1   Step2   Step3                             â”‚
â”‚                                                             â”‚
â”‚   ã€æ¤œå‡ºæ¡ä»¶ã€‘                                               â”‚
â”‚   1. åŠ é€Ÿåº¦ãŒé–¾å€¤ã‚’è¶…ãˆã‚‹                                   â”‚
â”‚   2. å‰ãƒ•ãƒ¬ãƒ¼ãƒ ã‚ˆã‚ŠåŠ é€Ÿåº¦ãŒå¤§ãã„ï¼ˆä¸Šæ˜‡ä¸­ï¼‰                 â”‚
â”‚   3. å‰ãƒ•ãƒ¬ãƒ¼ãƒ ã®åŠ é€Ÿåº¦ãŒé–¾å€¤æœªæº€ï¼ˆè°·ã‹ã‚‰å±±ã¸ï¼‰             â”‚
â”‚   4. å‰å›æ¤œå‡ºã‹ã‚‰ä¸€å®šæ™‚é–“çµŒéï¼ˆã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ï¼‰               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ãƒã‚¤ã‚ºå¯¾ç­–

| å¯¾ç­– | å®Ÿè£… |
|------|------|
| ãƒ­ãƒ¼ãƒ‘ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ | é«˜å‘¨æ³¢ãƒã‚¤ã‚ºã‚’é™¤å» |
| ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ | é€£ç¶šæ¤œå‡ºã‚’é˜²æ­¢ï¼ˆ0.3ç§’ï¼‰ |
| é–¾å€¤èª¿æ•´ | æ„Ÿåº¦è¨­å®šã§èª¿æ•´å¯èƒ½ |
| é‡åŠ›é™¤å» | ç·šå½¢åŠ é€Ÿåº¦ã®ã¿ã‚’ä½¿ç”¨ |

---

## 6. ã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

### 6.1 åˆæœŸã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                             â”‚   â”‚
â”‚   â”‚      ğŸ“±                     â”‚   â”‚
â”‚   â”‚      â†‘                      â”‚   â”‚
â”‚   â”‚   ã‚¹ãƒãƒ›ã‚’æ¥½ãªå§¿å‹¢ã§        â”‚   â”‚
â”‚   â”‚   æŒã£ã¦ãã ã•ã„            â”‚   â”‚
â”‚   â”‚                             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚        [æº–å‚™OK]             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚   ãƒ’ãƒ³ãƒˆ: åº§ã£ãŸã¾ã¾ã§ã‚‚          â”‚
â”‚   æŒ¯ã‚‹ã“ã¨ã§æ­©ã‘ã¾ã™              â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 ã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å‡¦ç†

```csharp
public class AccelerometerCalibrator : MonoBehaviour
{
    [SerializeField] private AccelerometerWalkController walkController;

    public void StartCalibration()
    {
        StartCoroutine(CalibrateCoroutine());
    }

    private IEnumerator CalibrateCoroutine()
    {
        // 3ç§’é–“ã®å¹³å‡ã‚’å–ã‚‹
        List<Vector3> samples = new List<Vector3>();

        for (int i = 0; i < 30; i++)
        {
            samples.Add(Input.acceleration);
            yield return new WaitForSeconds(0.1f);
        }

        // å¹³å‡ã‚’è¨ˆç®—
        Vector3 average = Vector3.zero;
        foreach (var sample in samples)
        {
            average += sample;
        }
        average /= samples.Count;

        // ã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨
        walkController.Calibrate();
    }
}
```

---

## 7. è¨­å®šç”»é¢

### 7.1 æ„Ÿåº¦è¨­å®š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ­©è¡Œæ„Ÿåº¦è¨­å®š                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚   æ„Ÿåº¦                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ ä½ã„ â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€ é«˜ã„   â”‚   â”‚ â† ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   [ãƒ†ã‚¹ãƒˆæ­©è¡Œ]               â”‚   â”‚ â† ãƒ†ã‚¹ãƒˆãƒœã‚¿ãƒ³
â”‚   â”‚                             â”‚   â”‚
â”‚   â”‚   æ¤œå‡ºã—ãŸæ­©æ•°: 0           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚   ãƒ’ãƒ³ãƒˆ:                           â”‚
â”‚   - æ¤œå‡ºã•ã‚Œãªã„å ´åˆã¯æ„Ÿåº¦ã‚’ä¸Šã’ã‚‹  â”‚
â”‚   - èª¤æ¤œå‡ºãŒå¤šã„å ´åˆã¯æ„Ÿåº¦ã‚’ä¸‹ã’ã‚‹  â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 æ“ä½œãƒ¢ãƒ¼ãƒ‰é¸æŠ

```csharp
public enum WalkMode
{
    Walk,      // å®Ÿéš›ã«æ­©ã
    Shake,     // å·¦å³ã«æŒ¯ã‚‹
    Touch      // ã‚¿ãƒƒãƒæ“ä½œï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
}
```

---

## 8. ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯

### 8.1 åŠ é€Ÿåº¦ã‚»ãƒ³ã‚µãƒ¼ãŒä½¿ãˆãªã„å ´åˆ

```csharp
public class WalkInputManager : MonoBehaviour
{
    [SerializeField] private AccelerometerWalkController accelerometerWalk;
    [SerializeField] private TouchWalkController touchWalk;

    private void Start()
    {
        // åŠ é€Ÿåº¦ã‚»ãƒ³ã‚µãƒ¼ã®åˆ©ç”¨å¯å¦ãƒã‚§ãƒƒã‚¯
        if (!SystemInfo.supportsAccelerometer)
        {
            // ã‚¿ãƒƒãƒæ“ä½œã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
            accelerometerWalk.enabled = false;
            touchWalk.enabled = true;

            ShowFallbackMessage();
        }
    }

    private void ShowFallbackMessage()
    {
        PocketToast.Show(
            "åŠ é€Ÿåº¦ã‚»ãƒ³ã‚µãƒ¼ãŒåˆ©ç”¨ã§ããªã„ãŸã‚ã€ã‚¿ãƒƒãƒæ“ä½œã«åˆ‡ã‚Šæ›¿ãˆã¾ã™",
            ToastType.Info
        );
    }
}
```

### 8.2 ã‚¿ãƒƒãƒæ“ä½œï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰

```csharp
public class TouchWalkController : MonoBehaviour
{
    public bool IsWalking { get; private set; }
    public Vector3 MoveDirection { get; private set; }

    private void Update()
    {
        if (Input.touchCount > 0 || Input.GetMouseButton(0))
        {
            IsWalking = true;

            // ã‚¿ãƒƒãƒä½ç½®ã‹ã‚‰æ–¹å‘ã‚’è¨ˆç®—
            Vector2 touchPos = Input.touchCount > 0
                ? Input.GetTouch(0).position
                : (Vector2)Input.mousePosition;

            // ç”»é¢ä¸­å¤®ã‹ã‚‰ã®ç›¸å¯¾ä½ç½®ã§æ–¹å‘æ±ºå®š
            Vector2 screenCenter = new Vector2(Screen.width / 2, Screen.height / 2);
            Vector2 direction = (touchPos - screenCenter).normalized;

            MoveDirection = new Vector3(direction.x, 0, direction.y);
        }
        else
        {
            IsWalking = false;
            MoveDirection = Vector3.zero;
        }
    }
}
```

---

## 9. é«˜é½¢è€…å‘ã‘é…æ…®

### 9.1 å®‰å…¨æ€§

| é…æ…® | å®Ÿè£… |
|------|------|
| åº§ã£ãŸã¾ã¾æ“ä½œå¯èƒ½ | æŒ¯ã‚‹ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ |
| éåº¦ãªå‹•ãã‚’è¦æ±‚ã—ãªã„ | æ„Ÿåº¦èª¿æ•´ã§å¯¾å¿œ |
| ç–²åŠ´è­¦å‘Š | 10åˆ†ã”ã¨ã«ä¼‘æ†©ã‚’ä¿ƒã™ |
| ç·Šæ€¥åœæ­¢ | ç”»é¢ã‚¿ãƒƒãƒ—ã§å³åº§ã«åœæ­¢ |

### 9.2 ç–²åŠ´è­¦å‘Š

```csharp
public class FatigueWarning : MonoBehaviour
{
    [SerializeField] private float warningIntervalMinutes = 10f;

    private float startTime;

    private void Start()
    {
        startTime = Time.time;
    }

    private void Update()
    {
        float elapsed = (Time.time - startTime) / 60f;

        if (elapsed >= warningIntervalMinutes)
        {
            ShowFatigueWarning();
            startTime = Time.time;
        }
    }

    private void ShowFatigueWarning()
    {
        PocketDialog.Show(
            "10åˆ†çµŒã¡ã¾ã—ãŸã€‚å°‘ã—ä¼‘æ†©ã—ã¾ã›ã‚“ã‹ï¼Ÿ",
            "ç¶šã‘ã‚‹",
            "ä¼‘æ†©ã™ã‚‹"
        );
    }
}
```

---

## 10. ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹

| # | ãƒ†ã‚¹ãƒˆå†…å®¹ | æœŸå¾…çµæœ |
|---|-----------|---------|
| 1 | æ­©è¡Œæ¤œå‡º | æ­©ãã¨ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãŒå‰é€² |
| 2 | æŒ¯ã‚Šæ¤œå‡º | æŒ¯ã‚‹ã¨ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãŒå‰é€² |
| 3 | å‚¾ãæ¤œå‡º | å‚¾ã‘ã‚‹ã¨æ–¹å‘è»¢æ› |
| 4 | æ„Ÿåº¦èª¿æ•´ | è¨­å®šå¤‰æ›´ã§æ¤œå‡ºæ„Ÿåº¦ãŒå¤‰åŒ– |
| 5 | ã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ | å§¿å‹¢ãƒªã‚»ãƒƒãƒˆ |
| 6 | ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ | ã‚»ãƒ³ã‚µãƒ¼ãªã—ã§ã‚¿ãƒƒãƒæ“ä½œ |
| 7 | æ­©æ•°ã‚«ã‚¦ãƒ³ãƒˆ | æ­£ç¢ºã«æ­©æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ |
| 8 | åœæ­¢æ¤œå‡º | å‹•ããŒæ­¢ã¾ã‚‹ã¨ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼åœæ­¢ |

---

## 11. æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

| ãƒ•ã‚¡ã‚¤ãƒ« | å½¹å‰² |
|----------|------|
| `Assets/Scripts/Pocket/Metaverse/AccelerometerWalkController.cs` | åŠ é€Ÿåº¦æ­©è¡Œåˆ¶å¾¡ |
| `Assets/Scripts/Pocket/Metaverse/AccelerometerCalibrator.cs` | ã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ |
| `Assets/Scripts/Pocket/Metaverse/TouchWalkController.cs` | ã‚¿ãƒƒãƒãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ |
| `Assets/Scripts/Pocket/Metaverse/WalkInputManager.cs` | å…¥åŠ›ç®¡ç† |
| `Assets/Scripts/Pocket/Metaverse/FatigueWarning.cs` | ç–²åŠ´è­¦å‘Š |
