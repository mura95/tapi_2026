# é€šè©±æ©Ÿèƒ½ï¼ˆé«˜é½¢è€…å‘ã‘éŸ³é‡ãƒ–ãƒ¼ã‚¹ãƒˆï¼‰

## 1. æ¦‚è¦

ãƒ¡ã‚¿ãƒãƒ¼ã‚¹å†…ã§ã®éŸ³å£°é€šè©±æ©Ÿèƒ½ã€‚é«˜é½¢è€…ã®è´åŠ›ã«é…æ…®ã—ãŸéŸ³é‡ãƒ–ãƒ¼ã‚¹ãƒˆæ©Ÿèƒ½ã‚’æ­è¼‰ã—ã€ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã®ä¼šè©±ã‚’æ”¯æ´ã™ã‚‹ã€‚

---

## 2. é«˜é½¢è€…å‘ã‘éŸ³å£°èª²é¡Œ

### 2.1 èª²é¡Œåˆ†æ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    é«˜é½¢è€…ã®éŸ³å£°é€šè©±èª²é¡Œ                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   ã€è´åŠ›ã®å•é¡Œã€‘                                             â”‚
â”‚   â”œâ”€â”€ é«˜å‘¨æ³¢ãŒèã“ãˆã«ãã„ï¼ˆå­éŸ³ãŒä¸æ˜ç­ï¼‰                  â”‚
â”‚   â”œâ”€â”€ å…¨ä½“çš„ãªè´åŠ›ä½ä¸‹                                     â”‚
â”‚   â””â”€â”€ é›‘éŸ³ã®ä¸­ã§ä¼šè©±ã‚’èãåˆ†ã‘ã«ãã„                       â”‚
â”‚                                                             â”‚
â”‚   ã€ç™ºè©±ã®å•é¡Œã€‘                                             â”‚
â”‚   â”œâ”€â”€ å£°ãŒå°ã•ã„                                          â”‚
â”‚   â”œâ”€â”€ æ»‘èˆŒãŒä¸æ˜ç­                                        â”‚
â”‚   â””â”€â”€ ãƒã‚¤ã‚¯ã‹ã‚‰é›¢ã‚Œã¦è©±ã™                                 â”‚
â”‚                                                             â”‚
â”‚   ã€ç’°å¢ƒã®å•é¡Œã€‘                                             â”‚
â”‚   â”œâ”€â”€ ã‚¹ãƒãƒ›ã®ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼éŸ³è³ª                               â”‚
â”‚   â”œâ”€â”€ å‘¨å›²ã®é›‘éŸ³                                          â”‚
â”‚   â””â”€â”€ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é…å»¶                                     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 è§£æ±ºã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

| èª²é¡Œ | è§£æ±ºç­– |
|------|--------|
| è´åŠ›ä½ä¸‹ | éŸ³é‡ãƒ–ãƒ¼ã‚¹ãƒˆ + ã‚¤ã‚³ãƒ©ã‚¤ã‚¶ãƒ¼ |
| é«˜å‘¨æ³¢ãŒèã“ãˆã«ãã„ | ä½å‘¨æ³¢å¼·èª¿ |
| å£°ãŒå°ã•ã„ | AGCï¼ˆè‡ªå‹•ã‚²ã‚¤ãƒ³èª¿æ•´ï¼‰å¼·ã‚ |
| é›‘éŸ³ | ãƒã‚¤ã‚ºæŠ‘åˆ¶å¼·ã‚ |
| ä¸æ˜ç­ãªç™ºè©± | VADæ„Ÿåº¦èª¿æ•´ |

---

## 3. éŸ³é‡ãƒ–ãƒ¼ã‚¹ãƒˆæ©Ÿèƒ½

### 3.1 ElderlyVoiceEnhancer

```csharp
using UnityEngine;
using Photon.Voice.Unity;

namespace TapHouse.Pocket.Metaverse
{
    /// <summary>
    /// é«˜é½¢è€…å‘ã‘éŸ³å£°å¼·åŒ–æ©Ÿèƒ½
    /// </summary>
    public class ElderlyVoiceEnhancer : MonoBehaviour
    {
        [Header("éŸ³é‡è¨­å®š")]
        [SerializeField, Range(1f, 3f)]
        private float volumeBoost = 2f;           // éŸ³é‡ãƒ–ãƒ¼ã‚¹ãƒˆå€ç‡

        [Header("ã‚¤ã‚³ãƒ©ã‚¤ã‚¶ãƒ¼")]
        [SerializeField]
        private bool enableEqualizer = true;

        [SerializeField, Range(0f, 2f)]
        private float lowFrequencyBoost = 1.5f;   // ä½å‘¨æ³¢ãƒ–ãƒ¼ã‚¹ãƒˆ

        [SerializeField, Range(0f, 2f)]
        private float midFrequencyBoost = 1.2f;   // ä¸­å‘¨æ³¢ãƒ–ãƒ¼ã‚¹ãƒˆ

        [SerializeField, Range(0f, 1f)]
        private float highFrequencyBoost = 0.8f;  // é«˜å‘¨æ³¢ï¼ˆä¸‹ã’ã‚‹ï¼‰

        [Header("Photon Voice")]
        [SerializeField]
        private Speaker speaker;

        private AudioSource audioSource;
        private AudioLowPassFilter lowPassFilter;
        private AudioHighPassFilter highPassFilter;

        private void Start()
        {
            audioSource = speaker.GetComponent<AudioSource>();

            // éŸ³é‡ãƒ–ãƒ¼ã‚¹ãƒˆé©ç”¨
            ApplyVolumeBoost();

            // ã‚¤ã‚³ãƒ©ã‚¤ã‚¶ãƒ¼è¨­å®š
            if (enableEqualizer)
            {
                SetupEqualizer();
            }
        }

        private void ApplyVolumeBoost()
        {
            // åŸºæœ¬éŸ³é‡ã‚’ä¸Šã’ã‚‹
            audioSource.volume = Mathf.Clamp(volumeBoost, 0f, 1f);

            // AudioMixerã§ã•ã‚‰ã«ãƒ–ãƒ¼ã‚¹ãƒˆ
            // â€»å®Ÿéš›ã«ã¯AudioMixerGroupã‚’ä½¿ç”¨
        }

        private void SetupEqualizer()
        {
            // ç°¡æ˜“ã‚¤ã‚³ãƒ©ã‚¤ã‚¶ãƒ¼ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®çµ„ã¿åˆã‚ã›ï¼‰

            // é«˜å‘¨æ³¢ã‚’ã‚«ãƒƒãƒˆï¼ˆèã“ãˆã«ãã„å‘¨æ³¢æ•°ã‚’ä¸‹ã’ã‚‹ï¼‰
            lowPassFilter = gameObject.AddComponent<AudioLowPassFilter>();
            lowPassFilter.cutoffFrequency = 4000f;  // 4kHzä»¥ä¸Šã‚’ã‚«ãƒƒãƒˆ
            lowPassFilter.lowpassResonanceQ = 1f;

            // ä½å‘¨æ³¢ã‚’ãƒ–ãƒ¼ã‚¹ãƒˆï¼ˆèãã‚„ã™ã„å‘¨æ³¢æ•°ã‚’å¼·èª¿ï¼‰
            // â€»Unityæ¨™æº–ã§ã¯é›£ã—ã„ãŸã‚ã€AudioMixerä½¿ç”¨ã‚’æ¨å¥¨
        }

        /// <summary>
        /// éŸ³é‡ãƒ–ãƒ¼ã‚¹ãƒˆè¨­å®šï¼ˆUIè¨­å®šç”»é¢ã‹ã‚‰ï¼‰
        /// </summary>
        public void SetVolumeBoost(float boost)
        {
            volumeBoost = Mathf.Clamp(boost, 1f, 3f);
            ApplyVolumeBoost();
        }

        /// <summary>
        /// ãƒ—ãƒªã‚»ãƒƒãƒˆï¼šè´åŠ›ãŒå°‘ã—ä½ä¸‹
        /// </summary>
        public void ApplyMildHearingLossPreset()
        {
            volumeBoost = 1.5f;
            lowFrequencyBoost = 1.2f;
            midFrequencyBoost = 1.1f;
            highFrequencyBoost = 0.9f;
            ApplySettings();
        }

        /// <summary>
        /// ãƒ—ãƒªã‚»ãƒƒãƒˆï¼šè´åŠ›ãŒä½ä¸‹
        /// </summary>
        public void ApplyModerateHearingLossPreset()
        {
            volumeBoost = 2.0f;
            lowFrequencyBoost = 1.5f;
            midFrequencyBoost = 1.3f;
            highFrequencyBoost = 0.7f;
            ApplySettings();
        }

        /// <summary>
        /// ãƒ—ãƒªã‚»ãƒƒãƒˆï¼šè´åŠ›ãŒã‹ãªã‚Šä½ä¸‹
        /// </summary>
        public void ApplySevereHearingLossPreset()
        {
            volumeBoost = 2.5f;
            lowFrequencyBoost = 1.8f;
            midFrequencyBoost = 1.5f;
            highFrequencyBoost = 0.5f;
            ApplySettings();
        }

        private void ApplySettings()
        {
            ApplyVolumeBoost();
            // ã‚¤ã‚³ãƒ©ã‚¤ã‚¶ãƒ¼è¨­å®šã‚‚æ›´æ–°
        }
    }
}
```

---

## 4. Recorderè¨­å®šï¼ˆé€ä¿¡å´ï¼‰

### 4.1 é«˜é½¢è€…å‘ã‘Recorderè¨­å®š

```csharp
using Photon.Voice.Unity;
using POpusCodec.Enums;

namespace TapHouse.Pocket.Metaverse
{
    public class ElderlyRecorderSettings : MonoBehaviour
    {
        [SerializeField] private Recorder recorder;

        public void ApplyElderlySettings()
        {
            // AGCï¼ˆè‡ªå‹•ã‚²ã‚¤ãƒ³èª¿æ•´ï¼‰ã‚’å¼·ã‚ã«
            recorder.UseAGC = true;

            // ãƒã‚¤ã‚ºæŠ‘åˆ¶ã‚’æœ‰åŠ¹ã«
            recorder.UseNS = true;

            // ã‚¨ã‚³ãƒ¼ã‚­ãƒ£ãƒ³ã‚»ãƒ«
            recorder.UseAEC = true;

            // VADæ„Ÿåº¦ã‚’èª¿æ•´ï¼ˆå°ã•ã„å£°ã‚‚æ‹¾ã†ï¼‰
            recorder.VoiceDetection = true;
            recorder.VoiceDetectionThreshold = 0.005f;  // é€šå¸¸ã‚ˆã‚Šä½ã‚

            // ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆã¨ãƒ“ãƒƒãƒˆãƒ¬ãƒ¼ãƒˆ
            recorder.SamplingRate = SamplingRate.Sampling24000;  // 24kHz
            recorder.Bitrate = 30000;  // 30kbps

            // ãƒ•ãƒ¬ãƒ¼ãƒ é•·
            recorder.FrameDuration = OpusCodec.FrameDuration.Frame20ms;
        }
    }
}
```

---

## 5. éŸ³é‡èª¿æ•´UI

### 5.1 é€šè©±è¨­å®šç”»é¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† æˆ»ã‚‹      é€šè©±è¨­å®š                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   ğŸ”Š ç›¸æ‰‹ã®å£°ã®éŸ³é‡         â”‚   â”‚
â”‚   â”‚                             â”‚   â”‚
â”‚   â”‚   å° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€ å¤§     â”‚   â”‚ â† ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼
â”‚   â”‚                             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   ğŸ¤ è‡ªåˆ†ã®å£°ã®æ„Ÿåº¦         â”‚   â”‚
â”‚   â”‚                             â”‚   â”‚
â”‚   â”‚   å¼± â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€ å¼·     â”‚   â”‚
â”‚   â”‚                             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   è´åŠ›ãƒ—ãƒªã‚»ãƒƒãƒˆ             â”‚   â”‚
â”‚   â”‚                             â”‚   â”‚
â”‚   â”‚   [æ¨™æº–] [å°‘ã—èã“ãˆã«ãã„]  â”‚   â”‚ â† ãƒ—ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³
â”‚   â”‚   [èã“ãˆã«ãã„]            â”‚   â”‚
â”‚   â”‚                             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   [ãƒ†ã‚¹ãƒˆé€šè©±]               â”‚   â”‚ â† è‡ªåˆ†ã®å£°ã‚’ç¢ºèª
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 VoiceSettingsUI

```csharp
using UnityEngine;
using UnityEngine.UI;
using TMPro;

namespace TapHouse.Pocket.Metaverse
{
    public class VoiceSettingsUI : MonoBehaviour
    {
        [Header("éŸ³é‡ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼")]
        [SerializeField] private Slider volumeSlider;
        [SerializeField] private TMP_Text volumeLabel;

        [Header("æ„Ÿåº¦ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼")]
        [SerializeField] private Slider sensitivitySlider;
        [SerializeField] private TMP_Text sensitivityLabel;

        [Header("ãƒ—ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³")]
        [SerializeField] private Button normalPresetButton;
        [SerializeField] private Button mildPresetButton;
        [SerializeField] private Button moderatePresetButton;

        [Header("ãƒ†ã‚¹ãƒˆé€šè©±")]
        [SerializeField] private Button testButton;
        [SerializeField] private TMP_Text testStatusText;

        [Header("Components")]
        [SerializeField] private ElderlyVoiceEnhancer voiceEnhancer;
        [SerializeField] private ElderlyRecorderSettings recorderSettings;

        private void Start()
        {
            // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼è¨­å®š
            volumeSlider.minValue = 1f;
            volumeSlider.maxValue = 3f;
            volumeSlider.value = 2f;

            sensitivitySlider.minValue = 0.001f;
            sensitivitySlider.maxValue = 0.02f;
            sensitivitySlider.value = 0.005f;

            // ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²
            volumeSlider.onValueChanged.AddListener(OnVolumeChanged);
            sensitivitySlider.onValueChanged.AddListener(OnSensitivityChanged);

            normalPresetButton.onClick.AddListener(() => ApplyPreset(0));
            mildPresetButton.onClick.AddListener(() => ApplyPreset(1));
            moderatePresetButton.onClick.AddListener(() => ApplyPreset(2));

            testButton.onClick.AddListener(StartTestCall);
        }

        private void OnVolumeChanged(float value)
        {
            voiceEnhancer.SetVolumeBoost(value);
            volumeLabel.text = $"{value:F1}å€";
        }

        private void OnSensitivityChanged(float value)
        {
            // VADæ„Ÿåº¦ã‚’è¨­å®š
        }

        private void ApplyPreset(int preset)
        {
            switch (preset)
            {
                case 0:
                    // æ¨™æº–
                    volumeSlider.value = 1.5f;
                    break;
                case 1:
                    voiceEnhancer.ApplyMildHearingLossPreset();
                    volumeSlider.value = 1.5f;
                    break;
                case 2:
                    voiceEnhancer.ApplyModerateHearingLossPreset();
                    volumeSlider.value = 2.0f;
                    break;
            }
        }

        private void StartTestCall()
        {
            // ãƒã‚¤ã‚¯å…¥åŠ›ã‚’éŒ²éŸ³ã—ã¦å†ç”Ÿ
            StartCoroutine(TestCallCoroutine());
        }

        private System.Collections.IEnumerator TestCallCoroutine()
        {
            testStatusText.text = "éŒ²éŸ³ä¸­...3ç§’é–“è©±ã—ã¦ãã ã•ã„";

            // 3ç§’é–“éŒ²éŸ³
            yield return new WaitForSeconds(3f);

            testStatusText.text = "å†ç”Ÿä¸­...";

            // éŒ²éŸ³ã‚’å†ç”Ÿ

            yield return new WaitForSeconds(3f);

            testStatusText.text = "";
        }
    }
}
```

---

## 6. è¿‘æ¥éŸ³å£°ã¨ã®é€£æº

### 6.1 ProximityVoiceWithEnhancer

```csharp
using UnityEngine;
using Photon.Voice.Unity;

namespace TapHouse.Pocket.Metaverse
{
    /// <summary>
    /// è¿‘æ¥éŸ³å£° + é«˜é½¢è€…å‘ã‘éŸ³é‡ãƒ–ãƒ¼ã‚¹ãƒˆ
    /// </summary>
    public class ProximityVoiceWithEnhancer : MonoBehaviour
    {
        [Header("è¿‘æ¥éŸ³å£°è¨­å®š")]
        [SerializeField] private float maxHearingDistance = 10f;
        [SerializeField] private float fullVolumeDistance = 2f;

        [Header("é«˜é½¢è€…å‘ã‘è¨­å®š")]
        [SerializeField] private float elderlyVolumeBoost = 2f;

        [Header("Components")]
        [SerializeField] private Speaker speaker;
        [SerializeField] private ElderlyVoiceEnhancer voiceEnhancer;

        private Transform localPlayer;
        private AudioSource audioSource;

        private void Start()
        {
            audioSource = speaker.GetComponent<AudioSource>();
            FindLocalPlayer();
        }

        private void Update()
        {
            if (localPlayer == null) return;

            UpdateVolumeByDistance();
        }

        private void UpdateVolumeByDistance()
        {
            float distance = Vector3.Distance(transform.position, localPlayer.position);

            // åŸºæœ¬ã®è·é›¢æ¸›è¡°
            float baseVolume = CalculateDistanceVolume(distance);

            // é«˜é½¢è€…å‘ã‘ãƒ–ãƒ¼ã‚¹ãƒˆé©ç”¨
            float boostedVolume = baseVolume * elderlyVolumeBoost;

            // æœ€å¤§1.0ã«ã‚¯ãƒ©ãƒ³ãƒ—ï¼ˆå¾Œæ®µã®AudioMixerã§ã•ã‚‰ã«ãƒ–ãƒ¼ã‚¹ãƒˆï¼‰
            audioSource.volume = Mathf.Clamp01(boostedVolume);
        }

        private float CalculateDistanceVolume(float distance)
        {
            if (distance <= fullVolumeDistance)
            {
                return 1f;
            }
            else if (distance >= maxHearingDistance)
            {
                return 0f;
            }
            else
            {
                float t = (distance - fullVolumeDistance) / (maxHearingDistance - fullVolumeDistance);
                return 1f - t;
            }
        }

        private void FindLocalPlayer()
        {
            // ãƒ­ãƒ¼ã‚«ãƒ«ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’æ¤œç´¢
        }
    }
}
```

---

## 7. éŸ³å£°ãƒ¬ãƒ™ãƒ«ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼

### 7.1 å…¥åŠ›ãƒ¬ãƒ™ãƒ«è¡¨ç¤º

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                     â”‚
â”‚   ğŸ¤ ã‚ãªãŸã®å£°                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â”‚   â”‚ â† å…¥åŠ›ãƒ¬ãƒ™ãƒ«
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚   ã€Œå£°ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€          â”‚
â”‚                                     â”‚
â”‚   ğŸ”Š ç›¸æ‰‹ã®å£°                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â”‚   â”‚ â† å‡ºåŠ›ãƒ¬ãƒ™ãƒ«
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 VoiceLevelIndicator

```csharp
using UnityEngine;
using UnityEngine.UI;
using Photon.Voice.Unity;

namespace TapHouse.Pocket.Metaverse
{
    public class VoiceLevelIndicator : MonoBehaviour
    {
        [Header("UI")]
        [SerializeField] private Slider inputLevelSlider;
        [SerializeField] private Slider outputLevelSlider;
        [SerializeField] private TMP_Text inputStatusText;

        [Header("Components")]
        [SerializeField] private Recorder recorder;

        private void Update()
        {
            UpdateInputLevel();
        }

        private void UpdateInputLevel()
        {
            // ãƒã‚¤ã‚¯å…¥åŠ›ãƒ¬ãƒ™ãƒ«ã‚’å–å¾—
            float level = recorder.LevelMeter.CurrentAvgAmp;
            inputLevelSlider.value = level;

            // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º
            if (recorder.IsCurrentlyTransmitting)
            {
                inputStatusText.text = "å£°ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™";
                inputStatusText.color = Color.green;
            }
            else if (level > 0.01f)
            {
                inputStatusText.text = "ã‚‚ã†å°‘ã—å¤§ããªå£°ã§";
                inputStatusText.color = Color.yellow;
            }
            else
            {
                inputStatusText.text = "ãƒã‚¤ã‚¯ã«å‘ã‹ã£ã¦è©±ã—ã¦ãã ã•ã„";
                inputStatusText.color = Color.gray;
            }
        }
    }
}
```

---

## 8. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### 8.1 ãƒã‚¤ã‚¯é–¢é€£ã‚¨ãƒ©ãƒ¼

```csharp
public class VoiceErrorHandler : MonoBehaviour
{
    public void HandleMicrophoneError(string error)
    {
        if (error.Contains("permission"))
        {
            ShowPermissionError();
        }
        else if (error.Contains("device"))
        {
            ShowDeviceError();
        }
        else
        {
            ShowGenericError(error);
        }
    }

    private void ShowPermissionError()
    {
        PocketDialog.Show(
            "ãƒã‚¤ã‚¯ã®ä½¿ç”¨ãŒè¨±å¯ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚\nè¨­å®šã‚¢ãƒ—ãƒªã‹ã‚‰è¨±å¯ã—ã¦ãã ã•ã„ã€‚",
            "è¨­å®šã‚’é–‹ã",
            "ã‚­ãƒ£ãƒ³ã‚»ãƒ«",
            onPositive: OpenSettings
        );
    }

    private void ShowDeviceError()
    {
        PocketDialog.Show(
            "ãƒã‚¤ã‚¯ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚\nãƒŸãƒ¥ãƒ¼ãƒˆçŠ¶æ…‹ã§é–‹å§‹ã—ã¾ã™ã€‚",
            "OK"
        );
    }
}
```

---

## 9. ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹

| # | ãƒ†ã‚¹ãƒˆå†…å®¹ | æœŸå¾…çµæœ |
|---|-----------|---------|
| 1 | éŸ³é‡ãƒ–ãƒ¼ã‚¹ãƒˆè¨­å®š | éŸ³é‡ãŒå¢—å¹…ã•ã‚Œã‚‹ |
| 2 | ãƒ—ãƒªã‚»ãƒƒãƒˆé©ç”¨ | è¨­å®šå€¤ãŒä¸€æ‹¬å¤‰æ›´ |
| 3 | ãƒ†ã‚¹ãƒˆé€šè©± | è‡ªåˆ†ã®å£°ãŒèã“ãˆã‚‹ |
| 4 | å…¥åŠ›ãƒ¬ãƒ™ãƒ«è¡¨ç¤º | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§æ›´æ–° |
| 5 | è¿‘æ¥éŸ³å£° | è·é›¢ã«å¿œã˜ã¦éŸ³é‡å¤‰åŒ– |
| 6 | ãƒã‚¤ã‚¯æ¨©é™ãªã— | ãƒŸãƒ¥ãƒ¼ãƒˆçŠ¶æ…‹ã§é–‹å§‹ |
| 7 | è´åŠ›ãƒ—ãƒªã‚»ãƒƒãƒˆ | ã‚¤ã‚³ãƒ©ã‚¤ã‚¶ãƒ¼é©ç”¨ |

---

## 10. é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ | èª¬æ˜ |
|-------------|------|
| [../../metaverse_walk/metaverse_walk_voice.md](../../metaverse_walk/metaverse_walk_voice.md) | ãŸã£ã·ãƒã‚¦ã‚¹ç‰ˆé€šè©±æ©Ÿèƒ½ |
| [pocket-metaverse-overview.md](./pocket-metaverse-overview.md) | ãƒã‚±ãƒƒãƒˆç‰ˆãƒ¡ã‚¿ãƒãƒ¼ã‚¹æ¦‚è¦ |

---

## 11. æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

| ãƒ•ã‚¡ã‚¤ãƒ« | å½¹å‰² |
|----------|------|
| `Assets/Scripts/Pocket/Metaverse/ElderlyVoiceEnhancer.cs` | éŸ³é‡ãƒ–ãƒ¼ã‚¹ãƒˆ |
| `Assets/Scripts/Pocket/Metaverse/ElderlyRecorderSettings.cs` | Recorderè¨­å®š |
| `Assets/Scripts/Pocket/Metaverse/VoiceSettingsUI.cs` | è¨­å®šUI |
| `Assets/Scripts/Pocket/Metaverse/ProximityVoiceWithEnhancer.cs` | è¿‘æ¥éŸ³å£°+ãƒ–ãƒ¼ã‚¹ãƒˆ |
| `Assets/Scripts/Pocket/Metaverse/VoiceLevelIndicator.cs` | ãƒ¬ãƒ™ãƒ«è¡¨ç¤º |
| `Assets/Scripts/Pocket/Metaverse/VoiceErrorHandler.cs` | ã‚¨ãƒ©ãƒ¼å‡¦ç† |
